<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>The Container is a Lie!</title>
  <meta name="author" content="Larry Garfield">
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="css/reveal.css">
  <link rel="stylesheet" href="platform-reveal/platform-theme/assets/css/styles.css" id="theme">
  <!-- Printing and PDF exports -->
  <script>
    var link = document.createElement( 'link' );
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match( /print-pdf/gi ) ? 'platform-theme/assets/css/print/pdf.css' : 'platform-theme/assets/css/print/paper.css';
    document.getElementsByTagName( 'head' )[0].appendChild( link );
  </script>

  <script src="platform-reveal/classer.js"></script>

  <!--[if lt IE 9]>
  <script src="lib/js/html5shiv.js"></script>
  <![endif]-->

  <style type="text/css">

    img.graphic {
    }

    ul.inline {
      margin: 0;
      padding: 0;
      list-style-type: none;
      text-align: center;
    }

    ul.inline li {
      display: inline;
    }

    /*overwrites a default style that
    vertically un-centered slides */
    .reveal .slides>section,
    .reveal .slides>section>section {
      padding: 0;
    }

    .reveal h2 + p.bigtext,
    .reveal p + p,
    .reveal h3 + p,
    .reveal h3 + h3,
    .reveal ul + ul {
      margin-top: 1em;
    }

    .reveal #final p + p {
      margin-top: 0;
    }

    .struck {
      text-decoration: line-through;
    }

    p.bigdeal {
      font-size: 200%;
      color: Red;
      font-style: italic;
      text-shadow: 3px 3px 10px #990000;
      display: block;
    }

    img.screenshot {
      border-radius: 5px;
      width: 900px;
    }

    blockquote em {
      color: Green;
      font-weight: bold !important;
    }

    .layout-columns {
      display: flex;
      justify-content: space-around;
    }

    .layout-centerline {
      align-items: center;
    }

    .layout-bottom-align {
      align-items: end;
    }

    .reveal .topspace {
      margin-top: 1em;
    }

    .reveal ul.logo-list {
      display: flex;
      list-style: none;
      justify-content: space-around;
      text-align: center;
      align-items: center;
    }

    .reveal ul.logo-list > li > img {
      width: 150px;
    }

    img.meme {
      width: 600px;
    }

    img.diagram {
      width: 80%;
    }

    p.fullscreen-credit {
      margin-top: 90%;
      font-size: small;
    }

  </style>

</head>
<!-- Change body class to "dark" if you prefer a dark theme, or "light" if you'd rather have a light theme-->
<body class="light">
<div class="reveal">
  <div class="logo">
    <p>Platform.sh</p>
  </div>
  <!-- Any section element inside of this container is displayed as a slide -->
  <div class="slides">

    <section>
      <h2>The Container is a Lie!</h2>
      <p>
        <small>Presented by <a href="http://www.garfieldtech.com/">Larry Garfield</a> (<a href="http://twitter.com/Crell">@Crell</a>)</small>
      </p>
    </section>
    <section class="l-2up">
      <h2><a href="http://twitter.com/Crell">@Crell</a></h2>
      <div>
        <img src="assets/larry-olaf-hug.jpg" alt="Larry implements Huggable" style="width: 350px; margin: 0" />
      </div>
      <div>
        <ul style="text-wrap: none">
          <li>Director of DX, <a href="http://www.platform.sh/">Platform.sh</a></li>
          <li style="margin-top: 1em;">PHP-FIG Core Committee</li>
          <li style="margin-top: 1em;"><code>implements Huggable</code></li>
        </ul>
      </div>
    </section>
    <section>
      <section data-background="assets/cloud-airplane-bulgaria.jpg">
        <aside class="notes">
          <ul>
            <li>Not those clouds</li>
            <li>Cloud-based hosting is the big thing</li>
            <li>What is a cloud, and what's it mean?</li>
            <li>Clouds usually built using "containers"...</li>
          </ul>
        </aside>
      </section>
      <section data-background="assets/container-food.jpg">
        <aside class="notes">
          <ul>
            <li>What is a container?</li>
            <li>Not this container.</li>
          </ul>
        </aside>
      </section>
      <section data-background="assets/container-ship-noaa.jpg" data-credit="https://www.flickr.com/photos/usoceangov/5369581593">
        <p class="fullscreen-credit">(Credit: <a href="https://www.flickr.com/photos/usoceangov/5369581593">https://www.flickr.com/photos/usoceangov/5369581593</a>)</p>        <aside class="notes">
          <ul>
            <li>It's like shipping containers, right?</li>
            <li>This is not a container.</li>
          </ul>
        </aside>
      </section>
      <section data-background="assets/whale-breach.jpg" data-credit="http://www.bbc.com/earth/story/20161124-humpback-whales-can-talk-with-their-bodies">
        <p class="fullscreen-credit">(Credit: <a href="http://www.bbc.com/earth/story/20161124-humpback-whales-can-talk-with-their-bodies">http://www.bbc.com/</a>)</p>
        <aside class="notes">
          <ul>
            <li>I hear it has to do with whales.</li>
            <li>This is not a container.</li>
            <li>Container for plankton?</li>
          </ul>
        </aside>
      </section>
      <section>
        <img src="assets/docker-logo-vertical.png" alt="Docker uses containers, but that's not what containers are." style="width: 50%" />
        <aside class="notes">
          <ul>
            <li>Uses containers, but not what containers are.</li>
          </ul>
        </aside>
      </section>
      <section>
        <img src="assets/lies-all-lies.jpg" alt="Containers are all lies" class="meme" data-credit="http://www.quickmeme.com/meme/3q8qw0" />
        <aside class="notes">
          <ul>
            <li>Containers are lies.</li>
            <li>Useful lies.</li>
            <li>All software is built on lies.</li>
          </ul>
        </aside>
      </section>
    </section>
    <section>
      <section>
        <h1>The first lie</h1>
        <h2>"Processes"</h2>
      </section>
      <section data-background="assets/pentium-cpu.jpg" data-credit="https://www.flickr.com/photos/3336/27756879319">
        <p class="fullscreen-credit">(Credit: <a href="https://www.flickr.com/photos/3336/27756879319">https://www.flickr.com/photos/3336/27756879319</a>)</p>
        <aside class="notes">
          <ul>
            <li>CPU, essentially single-thread</li>
            <li>Instructions one by one</li>
            <li>Program Counter tracks current instruction</li>
            <li>I/O is slow, do other stuff while waiting?</li>
          </ul>
        </aside>
      </section>
      <section>
        <h2>Operating System</h2>
        <ul class="layout-columns layout-centerline logo-list">
          <li><img src="assets/os-logo/tux.svg" data-credit="https://commons.wikimedia.org/wiki/File:Tux.svg" alt="Linux" /></li>
          <li><img src="assets/os-logo/windows-pre-xp.jpg" data-credit="https://commons.wikimedia.org/wiki/File:Microsoft_Windows_logo_(Pre-XP).jpg" alt="Windows" /></li>
          <li><img src="assets/os-logo/os-x-logo.svg" data-credit="https://commons.wikimedia.org/wiki/File:OS_X-Logo.svg" alt="OS X" /></li>
        </ul>
        <blockquote class="fragment">"Software that manages software"</blockquote>
      </section>
      <section>
        <h2>"Scheduler"</h2>
        <ul>
          <li class="fragment">Coordinates with CPU</li>
          <li class="fragment">Manages "context switching"</li>
          <li class="fragment">Swap out Program Counter</li>
        </ul>
        <aside class="notes">
          <ul>
            <li>Tick: Timer interrupt</li>
            <li>CPU: Hey OS, switch places?</li>
            <li>OS: Here's new PC</li>
          </ul>
        </aside>
      </section>
      <section>
        <h2>Operating system</h2>
        <p class="bigtext">Multiple cores?</p>
        <p class="fragment bigtext">Multiple threads?</p>
        <p class="fragment bigtext">Multiple Program Counters!</p>
        <aside class="notes">
          <ul>
            <li>How to keep track of PCs and memory?</li>
          </ul>
        </aside>
      </section>
      <section>
        <h2>"Process"</h2>
        <img src="assets/diagrams/processes.svg" class="diagram" alt="Processes are an ID, code stream, PC, and memory block" />
        <aside class="notes">
          <ul>
            <li>Code stream, Program Counter, Process ID, Memory block</li>
          </ul>
        </aside>
      </section>
      <section>
        <h2>Processes</h2>
        <ul>
          <li class="fragment">Know about each other</li>
          <li class="fragment">Communicate with each other</li>
          <li class="fragment">Get the same system info from OS</li>
          <li class="fragment">Spawn new processes</li>
          <li class="fragment">Exist in a hierarchy</li>
        </ul>
        <aside class="notes">
          <ul>
            <li>Create new by forking or "start that file on disk"</li>
            <li>First process is "init", controls all others</li>
          </ul>
        </aside>
      </section>
      <section>
        <h2>Virtual memory</h2>
        <img src="assets/ram-card.jpg" alt="A computer also contains memory" />
        <p><small>(Credit: <a href="https://www.flickr.com/photos/sebleedelisle/3519503529">https://www.flickr.com/photos/sebleedelisle/3519503529</a>)</small></p>
        <aside class="notes">
          <ul>
            <li>Code and data spread out at random</li>
            <li>OS and CPU lie to process</li>
            <li>Process thinks has contiguous memory from 0</li>
          </ul>
        </aside>
      </section>
      <section>
        <p><span style="color: red; font-size: 3em;">*</span><img src="assets/lies-continue.jpg" class="meme" style="vertical-align: top;" align="This is an over-simplification" data-credit="https://www.pinterest.com/pin/485051822345611119/" /></p>
        <aside class="notes">
          <ul>
            <li>Skipping some details</li>
            <li>Ignoring CPU caching, etc.</li>
            <li>Skipping all other things OS does</li>
          </ul>
        </aside>
      </section>
    </section>
    <section>
      <section>
        <img src="assets/lies-different.jpg" class="meme" alt="What if I told you we could tell different lies to different processes." />
      </section>
      <section>
        <h2>Namespaces</h2>
        <div class="layout-columns">
          <div>
            <img src="assets/os-logo/tux.svg" data-credit="https://commons.wikimedia.org/wiki/File:Tux.svg" alt="Linux specific stuff follows" />
          </div>
          <div>
            <!-- NOTE: Make this layout nicer. -->
            <ul style="display: flex; flex-direction: column; justify-content: space-around;">
              <li style="margin-top: 1em" class="fragment">Linux can tell different lies</li>
              <li style="margin-top: 1em" class="fragment">Bundle processes together</li>
              <li style="margin-top: 1em" class="fragment">Different lie for each bundle</li>
            </ul>
          </div>
        </div>
        <aside class="notes">
          <ul>
            <li>Linux kernel specific (not GNU)</li>
            <li>Other OSes didn't add features, or did very differently</li>
            <li>6 namespace types added piecemeal</li>
          </ul>
        </aside>
      </section>
    </section>
    <section>
      <section>
        <h2>UTS Namespace</h2>
        <p><img src="assets/diagrams/uts-namespace.svg" class="diagram" alt="The UTS namespace gives different sets of processes different hostnames" /></p>
        <p class="fragment"><code>sethostname(), setdomainname(), and uname()</code></p>
        <aside class="notes">
          <ul>
            <li>UTS = "Unix Time-sharing System"</li>
          </ul>
        </aside>
      </section>
    </section>
    <section>
      <section>
        <h2>Process Namespace</h2>
        <p><img src="assets/diagrams/pid-namespace.svg" class="diagram" alt="The PID namespace segments processes so they have a different keyspace, and 2 PIDs each." /></p>
        <p class="fragment">What about <code>/proc</code>?</p>
        <aside class="notes">
          <ul>
            <li>Process has ID inside and outside NS</li>
            <li>Inside NS, process only sees own NS</li>
            <li>Outside NS, see all processes</li>
          </ul>
        </aside>
      </section>
    </section>
    <section>
      <section>
        <h2>Mount Namespace</h2>
        <ul>
          <li class="fragment">super-chroot</li>
          <li class="fragment">New "root node"</li>
          <li class="fragment">File systems can be an image on disk</li>
        </ul>
        <aside class="notes">
          <ul>
            <li>chroot() changes root point within single tree</li>
            <li>namespaces give you a whole new tree</li>
          </ul>
        </aside>
      </section>
      <section>
        <h2>Mount Namespace</h2>
        <p><img src="assets/diagrams/mount-namespace.svg" class="diagram" alt="The mount namespace gives different processes different views on the file system." /></p>
        <aside class="notes">
          <ul>
            <li>Secret_plans is a .iso or something</li>
            <li>Procs starts others by calling "on disk": Changed what can even start</li>
          </ul>
        </aside>
      </section>
    </section>
    <section>
      <section>
        <h2>Network namespace</h2>
        <div class="layout-columns">
          <div>
            <h3 class="fragment">Physical devices</h3>
            <ul>
              <li class="fragment">Physical hardware</li>
              <li class="fragment">Cannot be namespaced</li>
            </ul>
          </div>
          <div>
            <h3 class="fragment">Virtual devices</h3>
            <ul>
              <li class="fragment">More lies!</li>
              <li class="fragment">Only one namespace</li>
              <li class="fragment">Can create in pairs</li>
            </ul>
          </div>
        </div>
        <aside class="notes">
          <ul>
            <li>Paired virtual devices can talk across NS boundary</li>
          </ul>
        </aside>
      </section>
      <section>
        <h2>Network namespace</h2>
        <p><img src="assets/diagrams/network-namespace.svg" class="diagram" alt="The network namespace lets multiple virtual devices appear as the same device to different processes." /></p>
        <aside class="notes">
          <ol>
            <li>veth0/veth1 created as a pair</li>
            <li>Move just veth1 to namespace</li>
            <li>OS gives IP addresses to each veth</li>
            <li>Setup firewall rules in OS like anything else</li>
            <li>Both processes are "listening on port 80"</li>
          </ol>
        </aside>
      </section>
    </section>
    <section>
      <section>
        <h2>User namespace</h2>
        <p class="fragment bigtext">Processes have user and group</p>
        <p class="fragment bigtext">Affects access control</p>
        <aside class="notes">
          <ul>
            <li>Limit process communication</li>
            <li>Limit signals (like terminate)</li>
            <li>"root" user has superpowers</li>
          </ul>
        </aside>
      </section>
      <section>
        <h2>User namespace</h2>
        <ul>
          <li class="fragment">Namespace-local user</li>
          <li class="fragment">Map local user to global user</li>
          <li class="fragment">... even root</li>
        </ul>
      </section>
      <section>
        <h2>User namespace</h2>
        <p><img src="assets/diagrams/user-namespace.svg" class="diagram" alt="The user namespace lets processes be a different user within a given scope." /></p>
        <p class="fragment bigtext">A process can be local-root!</p>
        <aside class="notes">
          <ul>
            <li>Lots of potential for weirdness</li>
            <li>Main benefit: local root</li>
            <li>Local root has root power selectively</li>
          </ul>
        </aside>
      </section>
    </section>
    <section>
      <section>
        <h2>Control Groups</h2>
        <blockquote class="fragment">The CGroup is not a lie!</blockquote>
        <p class="fragment bigtext">Scheduler tweaking</p>
        <aside class="notes">
          <ul>
            <li>Scheduler tries to be fair</li>
            <li>Greedy program can get more than fair share</li>
            <li>Fork a lot, just be slow, etc.</li>
          </ul>
        </aside>
      </section>
      <section>
        <h3>Control Group hierarchy</h3>
        <ul>
          <li class="fragment">Separate from process hierarchy</li>
          <li class="fragment">Nodes with "controllers"</li>
          <li class="fragment">Tracking, auditing, capping</li>
        </ul>
        <aside class="notes">
          <ul>
            <li>~dozen controllers, we care about CPU/mem cap</li>
            <li>Cap inherits down the tree</li>
            <li>Group A gets 1 GB mem, subgroup B gets 25% of that</li>
          </ul>
        </aside>
      </section>
      <section>
        <h2>Control Groups</h2>
        <p><img src="assets/diagrams/control-groups.svg" style="background: whitesmoke" class="diagram" alt="Control groups portion out fixed resources." /></p>
        <aside class="notes">
          <ul>
            <li>SQL process gets one core only</li>
            <li>Even if SQL runs wild, won't affect other cores</li>
            <li>Give each nginx process % of other core</li>
            <li>Can also allow % of all cores as group</li>
          </ul>
        </aside>
      </section>
    </section>
    <section>
      <section>
        <p>Can you use multiple namespaces?</p>
        <p class="fragment bigtext">Yes!</p>
        <aside class="notes">
          <ul>
            <li>Mix and match, even overlap</li>
            <li>Could get very weird...</li>
            <li>Most common answer</li>
          </ul>
        </aside>
      </section>
      <section>
        <p><img src="assets/use-all-the-namespaces.jpg" class="meme" alt="Use all the namespaces!" /></p>
      </section>
      <section>
        <p><img src="assets/diagrams/all-namespaces.svg" class="diagram" alt="All namespaces together!" /></p>
      </section>
      <section>
        <h3>Set of processes that...</h3>
        <ul>
          <li class="fragment">Know of only each other</li>
          <li class="fragment">Have a root user</li>
          <li class="fragment">Have their own file tree</li>
          <li class="fragment">Have their own network config</li>
          <li class="fragment">Have their own hostname</li>
          <li class="fragment">Have no way out of that box</li>
          <li class="fragment">Have a restricted finite set of resources</li>
        </ul>
      </section>
      <section>
        <p><img src="assets/philosoraptor-isolated-processes.jpg" class="meme" alt="If processes are that isolated, is that any different than having their own computer?" /></p>
        <p class="fragment bigtext">Let's call it a "Container"</p>
        <aside class="notes">
          <ul>
            <li>Can tell in a cgroup, but can't change anything</li>
            <li>Still share a kernel! But that's (maybe) it</li>
          </ul>
        </aside>
      </section>
      <section>
        <video preload="auto" class="stretch" data-autoplay>
          <source src="assets/obama-mic-drop.mp4" data-credit="" />
        </video>
        <aside class="notes">
          <ul>
            <li>Namespaces too fine-grained for daily practice</li>
          </ul>
        </aside>
      </section>
    </section>
    <section>
      <section>
        <h2>Coarser APIs</h2>
        <ul class="fragment layout-columns layout-bottom-align logo-list">
          <li>
            <a href="https://linuxcontainers.org/"><figure>
              <img src="assets/lxc-logo.png" alt="" />
              <figcaption>LXC (Linux Containers)</figcaption>
            </figure></a>
          </li>
          <li>
            <a href="https://docker.org/"><figure>
              <img src="assets/docker-logo-vertical.png" alt="" />
              <figcaption>Docker</figcaption>
            </figure></a>
          </li>
          <li>
            <a href="https://github.com/rkt/rkt"><figure>
              <img src="assets/rkt-logo.png" alt="" />
              <figcaption>Rkt (Rocket)</figcaption>
            </figure></a>
          </li>
        </ul>
        <ul class="fragment">
          <li><a href="https://github.com/tailhook/vagga">Vagga</a> (Rust)</li>
          <li><a href="https://github.com/p8952/bocker">Bocker</a> (Bash)</li>
        </ul>
        <aside class="notes">
          <ul>
            <li>Any language with full system commands</li>
            <li>Not PHP</li>
            <li>Docker layer on LXC, then forked</li>
          </ul>
        </aside>
      </section>
      <section data-background="assets/orchestration-music.jpg" data-credit="https://www.flickr.com/photos/blogocram/9682266245/">
        <h2 style="background: whitesmoke; border-radius: 5px; width: 50%;">Orchestration</h2>
        <!--<p class="fullscreen-credit">(Credit: <a href="https://www.flickr.com/photos/blogocram/9682266245/">https://www.flickr.com/photos/blogocram/9682266245/</a>)</p>-->
        <aside class="notes">
          <ul>
            <li>Keeping track of many containers and their settings</li>
          </ul>
        </aside>
      </section>
      <section>
        <h2>Read-only containers</h2>
        <ul>
          <li class="fragment">Load once, run multiple</li>
          <li class="fragment">No write collisions</li>
          <li class="fragment">Trivial overhead</li>
        </ul>
      </section>
      <section>
        <h2>Run anywhere?</h2>
        <p class="fragment"><img src="assets/lies-everywhere.jpg" class="meme" alt="Containers can't just run anywhere; they're specific to a container library" data-credit="https://makeameme.org/meme/lies-lies-mg8odl" /></p>
        <aside class="notes">
          <ul>
            <li>Library specific</li>
            <li>All that metadata</li>
            <li>"File" format</li>
          </ul>
        </aside>
      </section>
      <section data-background="assets/container-guest-house.jpg" data-credit="https://www.architecturendesign.net/22-most-beautiful-houses-made-from-shipping-containers/">
        <p class="fullscreen-credit">(Credit: <a href="https://www.architecturendesign.net/22-most-beautiful-houses-made-from-shipping-containers/">https://www.architecturendesign.net/22-most-beautiful-houses-made-from-shipping-containers/</a>)</p>
        <aside class="notes">
          <ul>
            <li>Hundreds of implicit dependencies</li>
            <li>Process starts proc by calling file</li>
            <li>Ship exact copies of all files!</li>
          </ul>
        </aside>
      </section>
      <section>
        <p class="bigtext">Static compiler for your entire system</p>
      </section>
    </section>
    <section>
      <section>
        <h2>A tale of two containers</h2>
        <ul class="fragment layout-columns layout-centerline logo-list">
          <li><img src="platform-reveal/platform-theme/assets/imgs/platform-logo-2c.svg" style="width: 300px" alt="Platform.sh" /></li>
          <li><img src="assets/docker-logo-vertical.png" style="width: 300px" alt="Docker" /></li>
        </ul>
      </section>
    </section>
    <section>
      <section>
        <p><img src="platform-reveal/platform-theme/assets/imgs/platform-logo-2c.svg" style="width: 300px" alt="Platform.sh" /></p>
        <ul>
          <li class="fragment">Built on LXC</li>
          <li class="fragment">Nested Squashfs</li>
          <li class="fragment">Integrated orchestration</li>
        </ul>
      </section>
      <section>
        <p><img src="platform-reveal/platform-theme/assets/imgs/platform-logo-2c.svg" style="width: 300px" alt="Platform.sh" /></p>
        <div class="layout-centerline layout-columns">
          <div><img src="assets/git-logo.svg" alt="Git" /></div>
          <div class="fragment">+</div>
          <div><code class="fragment">#!/bin/bash</code></div>
          <div class="fragment">=</div>
          <div class="fragment">Squashfs</div>
        </div>
        <aside class="notes">
          <ul>
            <li>Controlled via YAML files in Git</li>
          </ul>
        </aside>
      </section>
      <section>
        <p><img src="platform-reveal/platform-theme/assets/imgs/platform-logo-2c.svg" style="width: 300px" alt="Platform.sh" /></p>
        <div class="layout-columns">
          <div>
            <img src="assets/diagrams/platformsh-filesystem.svg" alt="A Platform.sh production file system is built from pieces" />
          </div>
          <div>
            <!-- NOTE: Make this layout nicer. -->
            <ul style="display: flex; flex-direction: column; justify-content: space-around;">
              <li style="margin-top: 1em" class="fragment">Base OS squashfs</li>
              <li style="margin-top: 1em" class="fragment">Application squashfs</li>
              <li style="margin-top: 1em" class="fragment">RAMdisk for config</li>
              <li style="margin-top: 1em" class="fragment">Network mounted user files</li>
            </ul>
          </div>
        </div>
        <aside class="notes">
          <ul>
            <li>Base OS image depends on config</li>
            <li>Shared by hundreds of containers</li>
            <li>Conf files built from Psh config</li>
          </ul>
        </aside>
      </section>
      <section>
        <h2>Few processes</h2>
        <pre class="font--24"><code class="bash" data-trim>
$ ps axf
 PID TTY      STAT   TIME COMMAND
   1 ?        Ss     0:06 init [2]
  72 ?        Ss     0:06 runsvdir -P /etc/service log: .................................................................
  78 ?        Ss     0:00  \_ runsv ssh
 105 ?        S      0:00  |   \_ /usr/sbin/sshd -D
2516 ?        Ss     0:00  |       \_ sshd: web [priv]
2518 ?        S      0:00  |           \_ sshd: web@pts/0
2519 pts/0    Ss     0:00  |               \_ -bash
2605 pts/0    R+     0:00  |                   \_ ps axf
  79 ?        Ss     0:00  \_ runsv nginx
  99 ?        S      0:00  |   \_ nginx: master process /usr/sbin/nginx -g daemon off; error_log /var/log/error.log; -c /
 104 ?        S      0:00  |       \_ nginx: worker process
  80 ?        Ss     0:00  \_ runsv newrelic
  81 ?        Ss     0:00  \_ runsv app
  89 ?        Ss     0:22      \_ php-fpm: master process (/etc/php/7.2-zts/fpm/php-fpm.conf)
        </code></pre>
        <aside class="notes">
          <ul>
            <li>All the processes in the app container</li>
            <li>runsv is part of runit</li>
            <li>Only real processes are ssh, nginx, php-fpm</li>
          </ul>
        </aside>
      </section>
      <section>
        <h3>Cluster is the unit of deployment</h3>
        <p><img src="assets/diagrams/platformsh-cluster.svg" class="diagram" alt="The same setup applies across all containers in a cluster" /></p>
        <aside class="notes">
          <ul>
            <li>Services have no app image, but do have FS or ramdisk</li>
          </ul>
        </aside>
      </section>
    </section>
    <section>
      <section>
        <p><img src="assets/docker-logo-horizontal.png" alt="Docker" /></p>
        <ul>
          <li class="fragment">Layered filesystem</li>
          <li class="fragment">No init process</li>
          <li class="fragment">Optimized for 1 process</li>
        </ul>
      </section>
      <section>
        <h2>Docker layered filesystem</h2>
        <p><img src="assets/diagrams/docker-filesystem.svg" class="diagram" alt="Docker's file system is layered" /></p>
        <aside class="notes">
          <ul>
            <li>Layered like transparencies</li>
            <li>Good for sharing lower-layers with many containers</li>
            <li>Bad if you have lots of layers, gets slower</li>
          </ul>
        </aside>
      </section>
      <section>
        <p class="bigtext">Different uses, different trade-offs</p>
        <aside class="notes">
          <ul>
            <li>Ubuntu Snaps</li>
            <li>RedHat Flatpack</li>
          </ul>
        </aside>
      </section>
    </section>
    <section>
      <section>
        <h3>Enjoy your lies</h3>
        <ul>
          <li class="fragment">All software is built on lies</li>
          <li class="fragment">Embrace them!</li>
          <li class="fragment">Cloud computing is a multi-layered lie</li>
        </ul>
      </section>
      <section data-background="assets/cake-is-a-lie.jpg" data-credit="https://www.flickr.com/photos/hrbrmstr/6015402227/">
        <p class="fullscreen-credit">(Credit: <a href="https://www.flickr.com/photos/hrbrmstr/6015402227/">https://www.flickr.com/photos/hrbrmstr/6015402227/</a>)</p>
      </section>
    </section>



    <div style="display:none">

      <img src="assets/lies-pinocchio.jpg" alt="Containers are lies!">
      <p><small>Credit: <a href="https://www.essaytigers.com/blog/20-big-fat-lies-college-professors-tell-us">https://www.essaytigers.com/</a></small></p>

    </div>

    <section id="final">
      <h2>Larry Garfield</h2>
      <h2><a href="http://twitter.com/Crell">@Crell</a></h2>
      <p>Director of Developer Experience <a href="http://www.platform.sh/">Platform.sh</a></p>
      <p>Continuous Deployment Cloud Hosting</p>
      <p>Stalk us at <a href="http://twitter.com/Platformsh">@PlatformSH</a></p>
      <p style="margin-top: 2em;"><small>Diagrams by Allison Simmons</small></p>
    </section>

  </div>

</div>

<script src="lib/js/head.min.js"></script>
<script src="js/reveal.js"></script>

<script>

  // Full list of configuration options available at:
  // https://github.com/hakimel/reveal.js#configuration
  Reveal.initialize({
    controls: true,
    progress: true,
    history: true,
    center: true,

    transition: 'slide', // none/fade/slide/convex/concave/zoom

    // Optional reveal.js plugins
    dependencies: [
      { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
      { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
      { src: 'plugin/zoom-js/zoom.js', async: true },
      { src: 'plugin/notes/notes.js', async: true }
    ]
  });

</script>

</body>
</html>
